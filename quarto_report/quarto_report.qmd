---
title: Airbiome Microbial Association Networks Summary
fig-align: center
execute:
  echo: false
  output: asis
jupyter: python3
format:
  html:
    toc: true
    toc-location: left
    toc-depth: 3
    page-layout: full
    self-contained: true
include-in-header:
    text: |
        <style type="text/css">
        .footer {
        position: relative;
        left: 0;
        width: 100%;
        text-align: center;
        margin-top: 20px;
        }
        </style>
include-after-body:
    text: |
        <footer class="footer">
            This report was generated with
            <a href="https://github.com/Multiomics-Analytics-Group/vuegen" target="_blank">
                <img src="https://raw.githubusercontent.com/Multiomics-Analytics-Group/vuegen/HEAD/docs/images/logo/vuegen_logo.svg" alt="VueGen" width="65px">
            </a>
            | Copyright 2025 <a href="https://github.com/Multiomics-Analytics-Group" target="_blank">
            Multiomics Network Analytics Group (MoNA)</a>
        </footer>
---

```{python}
#| label: 'Imports'
from itables import show, init_notebook_mode
from pathlib import Path
import json
import pandas as pd
import plotly.io as pio
import requests


init_notebook_mode(all_interactive=True)
report_dir = Path().cwd()
```

# Adjacency Networks
## Nopge Genus Adj
### Network Metrics All Thresholds
```{python}
#| label: 'Network Metrics All Thresholds 1'
#| fig-cap: ""

df = pd.read_excel(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_genus_adj/1_Network_metrics_all_thresholds.xlsx')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Cclasso No Singletons Threshold 65 Edgelist
**Number of nodes:** 252

**Number of edges:** 3056


<div style="text-align: center;">
<iframe src="static/Cclasso_No_Singletons_Threshold_65_Edgelist.html" alt="Cclasso No Singletons Threshold 65 Edgelist plot"
        width="800px" height="630px">
</iframe>
</div>

### Module Taxa Membership
```{python}
#| label: 'Module Taxa Membership 2'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_genus_adj/3_module_taxa_membership.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means
```{python}
#| label: 'Module Means 3'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_genus_adj/4_module_means.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means Heatmap

```{python}
#| label: 'Module Means Heatmap 2'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_genus_adj/5_module_means_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Variability

```{python}
#| label: 'Module Variability 3'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_genus_adj/6_module_variability.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Metadata Correlations
```{python}
#| label: 'Module Metadata Correlations 4'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_genus_adj/7_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Metadata Correlations Volcano Plot

```{python}
#| label: 'Module Metadata Correlations Volcano Plot 4'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_genus_adj/8_module_metadata_correlations_volcano_plot.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Significant Module Metadata Correlations
```{python}
#| label: 'Significant Module Metadata Correlations 5'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_genus_adj/9_significant_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Top Correlations Heatmap

```{python}
#| label: 'Top Correlations Heatmap 5'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_genus_adj/10_top_correlations_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

## Nopge Species Adj
### Network Metrics All Thresholds
```{python}
#| label: 'Network Metrics All Thresholds 6'
#| fig-cap: ""

df = pd.read_excel(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_species_adj/1_Network_metrics_all_thresholds.xlsx')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Cclasso No Singletons Threshold 65 Edgelist
**Number of nodes:** 54

**Number of edges:** 142


<div style="text-align: center;">
<iframe src="static/Cclasso_No_Singletons_Threshold_65_Edgelist.html" alt="Cclasso No Singletons Threshold 65 Edgelist plot"
        width="800px" height="630px">
</iframe>
</div>

### Module Taxa Membership
```{python}
#| label: 'Module Taxa Membership 7'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_species_adj/3_module_taxa_membership.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means
```{python}
#| label: 'Module Means 8'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_species_adj/4_module_means.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means Heatmap

```{python}
#| label: 'Module Means Heatmap 7'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_species_adj/5_module_means_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Variability

```{python}
#| label: 'Module Variability 8'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_species_adj/6_module_variability.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Metadata Correlations
```{python}
#| label: 'Module Metadata Correlations 9'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_species_adj/7_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Metadata Correlations Volcano Plot

```{python}
#| label: 'Module Metadata Correlations Volcano Plot 9'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_species_adj/8_module_metadata_correlations_volcano_plot.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Top Correlations Heatmap

```{python}
#| label: 'Top Correlations Heatmap 10'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/NOPGE_species_adj/9_top_correlations_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

## Pge Genus Adj
### Network Metrics All Thresholds
```{python}
#| label: 'Network Metrics All Thresholds 10'
#| fig-cap: ""

df = pd.read_excel(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_genus_adj/1_Network_metrics_all_thresholds.xlsx')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Cclasso No Singletons Threshold 45 Edgelist
**Number of nodes:** 47

**Number of edges:** 73


<div style="text-align: center;">
<iframe src="static/Cclasso_No_Singletons_Threshold_45_Edgelist.html" alt="Cclasso No Singletons Threshold 45 Edgelist plot"
        width="800px" height="630px">
</iframe>
</div>

### Module Taxa Membership
```{python}
#| label: 'Module Taxa Membership 11'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_genus_adj/3_module_taxa_membership.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means
```{python}
#| label: 'Module Means 12'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_genus_adj/4_module_means.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means Heatmap

```{python}
#| label: 'Module Means Heatmap 12'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_genus_adj/5_module_means_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Variability

```{python}
#| label: 'Module Variability 13'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_genus_adj/6_module_variability.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Metadata Correlations
```{python}
#| label: 'Module Metadata Correlations 13'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_genus_adj/7_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Metadata Correlations Volcano Plot

```{python}
#| label: 'Module Metadata Correlations Volcano Plot 14'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_genus_adj/8_module_metadata_correlations_volcano_plot.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Significant Module Metadata Correlations
```{python}
#| label: 'Significant Module Metadata Correlations 14'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_genus_adj/9_significant_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Top Correlations Heatmap

```{python}
#| label: 'Top Correlations Heatmap 15'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_genus_adj/10_top_correlations_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

## Pge Species Adj
### Network Metrics All Thresholds
```{python}
#| label: 'Network Metrics All Thresholds 15'
#| fig-cap: ""

df = pd.read_excel(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_species_adj/1_Network_metrics_all_thresholds.xlsx')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Cclasso No Singletons Threshold 50 Edgelist
**Number of nodes:** 84

**Number of edges:** 139


<div style="text-align: center;">
<iframe src="static/Cclasso_No_Singletons_Threshold_50_Edgelist.html" alt="Cclasso No Singletons Threshold 50 Edgelist plot"
        width="800px" height="630px">
</iframe>
</div>

### Module Taxa Membership
```{python}
#| label: 'Module Taxa Membership 16'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_species_adj/3_module_taxa_membership.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means
```{python}
#| label: 'Module Means 17'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_species_adj/4_module_means.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means Heatmap

```{python}
#| label: 'Module Means Heatmap 17'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_species_adj/5_module_means_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Variability

```{python}
#| label: 'Module Variability 18'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_species_adj/6_module_variability.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Metadata Correlations
```{python}
#| label: 'Module Metadata Correlations 18'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_species_adj/7_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Metadata Correlations Volcano Plot

```{python}
#| label: 'Module Metadata Correlations Volcano Plot 19'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_species_adj/8_module_metadata_correlations_volcano_plot.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Significant Module Metadata Correlations
```{python}
#| label: 'Significant Module Metadata Correlations 19'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_species_adj/9_significant_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Top Correlations Heatmap

```{python}
#| label: 'Top Correlations Heatmap 20'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Adjacency_networks/PGE_species_adj/10_top_correlations_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

# Association Networks
## Nopge Genus Asso
### Network Metrics All Thresholds
```{python}
#| label: 'Network Metrics All Thresholds 20'
#| fig-cap: ""

df = pd.read_excel(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_genus_asso/1_Network_metrics_all_thresholds.xlsx')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Cclasso No Singletons Threshold 80 Edgelist
**Number of nodes:** 180

**Number of edges:** 1263


<div style="text-align: center;">
<iframe src="static/Cclasso_No_Singletons_Threshold_80_Edgelist.html" alt="Cclasso No Singletons Threshold 80 Edgelist plot"
        width="800px" height="630px">
</iframe>
</div>

### Module Taxa Membership
```{python}
#| label: 'Module Taxa Membership 21'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_genus_asso/3_module_taxa_membership.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means
```{python}
#| label: 'Module Means 22'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_genus_asso/4_module_means.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means Heatmap

```{python}
#| label: 'Module Means Heatmap 22'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_genus_asso/5_module_means_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Variability

```{python}
#| label: 'Module Variability 23'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_genus_asso/6_module_variability.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Metadata Correlations
```{python}
#| label: 'Module Metadata Correlations 23'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_genus_asso/7_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Metadata Correlations Volcano Plot

```{python}
#| label: 'Module Metadata Correlations Volcano Plot 24'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_genus_asso/8_module_metadata_correlations_volcano_plot.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Significant Module Metadata Correlations
```{python}
#| label: 'Significant Module Metadata Correlations 24'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_genus_asso/9_significant_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Top Correlations Heatmap

```{python}
#| label: 'Top Correlations Heatmap 25'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_genus_asso/10_top_correlations_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

## Nopge Species Asso
### Network Metrics All Thresholds
```{python}
#| label: 'Network Metrics All Thresholds 25'
#| fig-cap: ""

df = pd.read_excel(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_species_asso/1_Network_metrics_all_thresholds.xlsx')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Cclasso No Singletons Threshold 75 Edgelist
**Number of nodes:** 75

**Number of edges:** 215


<div style="text-align: center;">
<iframe src="static/Cclasso_No_Singletons_Threshold_75_Edgelist.html" alt="Cclasso No Singletons Threshold 75 Edgelist plot"
        width="800px" height="630px">
</iframe>
</div>

### Module Taxa Membership
```{python}
#| label: 'Module Taxa Membership 26'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_species_asso/3_module_taxa_membership.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means
```{python}
#| label: 'Module Means 27'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_species_asso/4_module_means.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means Heatmap

```{python}
#| label: 'Module Means Heatmap 27'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_species_asso/5_module_means_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Variability

```{python}
#| label: 'Module Variability 28'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_species_asso/6_module_variability.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Metadata Correlations
```{python}
#| label: 'Module Metadata Correlations 28'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_species_asso/7_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Metadata Correlations Volcano Plot

```{python}
#| label: 'Module Metadata Correlations Volcano Plot 29'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_species_asso/8_module_metadata_correlations_volcano_plot.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Significant Module Metadata Correlations
```{python}
#| label: 'Significant Module Metadata Correlations 29'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_species_asso/9_significant_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Top Correlations Heatmap

```{python}
#| label: 'Top Correlations Heatmap 30'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/NOPGE_species_asso/10_top_correlations_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

## Pge Genus Asso
### Network Metrics All Thresholds
```{python}
#| label: 'Network Metrics All Thresholds 30'
#| fig-cap: ""

df = pd.read_excel(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/PGE_genus_asso/1_Network_metrics_all_thresholds.xlsx')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Cclasso No Singletons Threshold 40 Edgelist
**Number of nodes:** 53

**Number of edges:** 89


<div style="text-align: center;">
<iframe src="static/Cclasso_No_Singletons_Threshold_40_Edgelist.html" alt="Cclasso No Singletons Threshold 40 Edgelist plot"
        width="800px" height="630px">
</iframe>
</div>

### Module Taxa Membership
```{python}
#| label: 'Module Taxa Membership 31'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/PGE_genus_asso/3_module_taxa_membership.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means
```{python}
#| label: 'Module Means 32'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/PGE_genus_asso/4_module_means.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means Heatmap

```{python}
#| label: 'Module Means Heatmap 32'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/PGE_genus_asso/5_module_means_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Variability

```{python}
#| label: 'Module Variability 33'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/PGE_genus_asso/6_module_variability.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Metadata Correlations
```{python}
#| label: 'Module Metadata Correlations 33'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/PGE_genus_asso/7_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Metadata Correlations Volcano Plot

```{python}
#| label: 'Module Metadata Correlations Volcano Plot 34'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/PGE_genus_asso/8_module_metadata_correlations_volcano_plot.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Significant Module Metadata Correlations
```{python}
#| label: 'Significant Module Metadata Correlations 34'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/PGE_genus_asso/9_significant_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Top Correlations Heatmap

```{python}
#| label: 'Top Correlations Heatmap 35'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/PGE_genus_asso/10_top_correlations_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

## Pge Species Asso
### Network Metrics All Thresholds
```{python}
#| label: 'Network Metrics All Thresholds 35'
#| fig-cap: ""

df = pd.read_excel(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/PGE_species_asso/1_Network_metrics_all_thresholds.xlsx')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Cclasso No Singletons Threshold 55 Edgelist
**Number of nodes:** 18

**Number of edges:** 20


<div style="text-align: center;">
<iframe src="static/Cclasso_No_Singletons_Threshold_55_Edgelist.html" alt="Cclasso No Singletons Threshold 55 Edgelist plot"
        width="800px" height="630px">
</iframe>
</div>

### Module Taxa Membership
```{python}
#| label: 'Module Taxa Membership 36'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/PGE_species_asso/3_module_taxa_membership.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means
```{python}
#| label: 'Module Means 37'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/PGE_species_asso/4_module_means.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Means Heatmap

```{python}
#| label: 'Module Means Heatmap 37'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/PGE_species_asso/5_module_means_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Variability

```{python}
#| label: 'Module Variability 38'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/PGE_species_asso/6_module_variability.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Module Metadata Correlations
```{python}
#| label: 'Module Metadata Correlations 38'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/PGE_species_asso/7_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Module Metadata Correlations Volcano Plot

```{python}
#| label: 'Module Metadata Correlations Volcano Plot 39'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/PGE_species_asso/8_module_metadata_correlations_volcano_plot.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```

### Significant Module Metadata Correlations
```{python}
#| label: 'Significant Module Metadata Correlations 39'
#| fig-cap: ""

df = pd.read_csv(report_dir / '../AirBiome_microbial_association_networks_summary/Association_networks/PGE_species_asso/9_significant_module_metadata_correlations.csv')

show(df, classes="display nowrap compact", lengthMenu=[3, 5, 10])
```

### Top Correlations Heatmap

```{python}
#| label: 'Top Correlations Heatmap 40'
#| fig-cap: ""

with open(report_dir /'../AirBiome_microbial_association_networks_summary/Association_networks/PGE_species_asso/10_top_correlations_heatmap.json', 'r') as plot_file:
    plot_json = json.load(plot_file)

# Keep only 'data' and 'layout' sections
plot_json = {key: plot_json[key] for key in plot_json
                if key in ['data', 'layout']
            }
# Remove 'frame' section in 'data'
plot_json['data'] = [{k: v for k, v in entry.items() if k != 'frame'}
                            for entry in plot_json.get('data', [])
                    ]
# Convert JSON to string
plot_json_str = json.dumps(plot_json)
# Create the plotly plot
fig_plotly = pio.from_json(plot_json_str)
fig_plotly.update_layout(autosize=False, width=950, height=400,
                         margin=dict(b=50, t=50, l=50, r=50)
                         )

fig_plotly.show()
```
